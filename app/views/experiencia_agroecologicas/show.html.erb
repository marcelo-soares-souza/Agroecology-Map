<% title @experiencia_agroecologica.nome %>

<%= link_to t(:register_new_experience), new_experiencia_agroecologica_path, :class => "btn btn-primary", :style => "float:right;" %>
<br><br><br>

<ul class="nav nav-tabs">
  <li class="nav-item">
    <%= link_to link_to t(:experiences_in_agroecology), experiencia_agroecologicas_path, :class => "nav-link" %>
  </li>
  <li class="nav-item">
    <%= link_to @experiencia_agroecologica.nome.truncate(49), experiencia_agroecologica_path(@experiencia_agroecologica.id), :class => "nav-link active" %>
  </li>
  <li class="nav-item">
    <%= link_to "#{t(:photos)} (#{@experiencia_agroecologica.midias.count})", experiencia_agroecologica_midias_path(@experiencia_agroecologica), :class => "nav-link" %>
  </li>
</ul>

<br>

<div class="tab-content" style="min-height: 64px;">
  <div class="tab-pane active">
    <% if @experiencia_agroecologica.midias[0] %>
      <%= image_tag(@experiencia_agroecologica.midias[0].imagem.url(:medium), :width => "250") %>
    <% end %>
    <br><br>
    <h3><%= @experiencia_agroecologica.nome %></h3>
    <%= "<strong>#{t(:central_theme)}:</strong><br>#{@tema_experiencia_agroecologicas.key(@experiencia_agroecologica.tema_experiencia_agroecologica.id)}&nbsp;".html_safe if @experiencia_agroecologica.tema_experiencia_agroecologica.nome? %>
    <%= "<br><br><strong>#{t(:resume)}:</strong><br><div class='text-box'>#{@experiencia_agroecologica.resumo}&nbsp;</div>".html_safe if @experiencia_agroecologica.resumo? %>
    <%= "<br><br><strong>#{t('location.data')}:</strong><br>#{link_to @experiencia_agroecologica.local.nome, local_path(@experiencia_agroecologica.local)}&nbsp;".html_safe if @experiencia_agroecologica.local.nome? %>
    <%= "<br><br><strong>#{t(:responsible_for_information)}:</strong><br>#{link_to @experiencia_agroecologica.usuario.nome, usuario_path(@experiencia_agroecologica.usuario)}&nbsp;".html_safe if @experiencia_agroecologica.usuario.nome? %>
    <%= "<br><br><strong>#{t(:organization)}:</strong><br>#{@experiencia_agroecologica.local.organizacoes.map { |organizacao| link_to organizacao.nome, organizacao_path(organizacao) }.join(", ").html_safe}&nbsp;".html_safe if @experiencia_agroecologica.local.organizacoes.count > 0 %>
    <%= "<br><br><strong>#{t(:observation)}:</strong><br><div class='text-box'>#{@experiencia_agroecologica.observacao}&nbsp;</div>".html_safe if @experiencia_agroecologica.observacao? %>

    <br><br><strong><%= t(:comments) %>:</strong>
    <% if @experiencia_agroecologica.comentarios.count > 0 %>
      <%= render 'comentarios', comentarios: @experiencia_agroecologica.comentarios %>
    <% end %>

    <%= "<b>#{link_to t(:log_into_the_system_to_make_comments), new_usuario_session_path, :class => 'text-danger'}</b>".html_safe if !usuario_signed_in? %>

    <br><br>
    <div class='text-box'>
      <%= render 'comentar', comentar: @comentar if usuario_signed_in? %>
    </div>
  </div>
</div>

<% if usuario_signed_in? %>
  <% if current_usuario.admin? or current_usuario.id == @experiencia_agroecologica.usuario.id %>
    <br><br>
    <div id="experiencia_agroecologica-footer">
      <div class="form-actions">
        <%= link_to t(:edit), edit_experiencia_agroecologica_path(@experiencia_agroecologica), :class => 'btn btn-success' %>
        <%= link_to t(:send_photo), new_experiencia_agroecologica_midia_path(@experiencia_agroecologica), :class => "btn btn-warning" %>
        <%= link_to t(:destroy), experiencia_agroecologica_path(@experiencia_agroecologica), :method => 'delete', :data => { :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'VocÃª tem Certeza?')) }, :class => 'btn btn-danger' %>
      </div>
    </div>
  <% end %>
<% end %>
